set(CMAKE_INCLUDE_CURRENT_DIR on)

include_directories(${FRAMERECEIVER_DIR}/include ${ODINDATA_INCLUDE_DIRS} ${Boost_INCLUDE_DIRS} ${LOG4CXX_INCLUDE_DIRS}/.. ${ZEROMQ_INCLUDE_DIRS})

# Add library for LATRD decoder
add_library(LATRDFrameDecoder SHARED LATRDFrameDecoder.cpp LATRDFrameDecoderLib.cpp)
target_link_libraries(LATRDFrameDecoder ${ODINDATA_LIBRARIES} ${Boost_LIBRARIES} ${LOG4CXX_LIBRARIES} ${ZEROMQ_LIBRARIES})

string(TIMESTAMP EXEC_TIME)
set(LATRD_EXEC_SCRIPT ${CMAKE_RUNTIME_OUTPUT_DIRECTORY}/execute_latrd_receiver)
file(WRITE ${LATRD_EXEC_SCRIPT} "#!/bin/bash\n")
file(APPEND ${LATRD_EXEC_SCRIPT} "\n")
file(APPEND ${LATRD_EXEC_SCRIPT} "# This file is autogenerated - DO NOT EDIT\n")
file(APPEND ${LATRD_EXEC_SCRIPT} "# Generated on ${EXEC_TIME}\n")
file(APPEND ${LATRD_EXEC_SCRIPT} "\n")
file(APPEND ${LATRD_EXEC_SCRIPT} "# Executes the LATRD ODIN-DATA FrameReceiver\n")
file(APPEND ${LATRD_EXEC_SCRIPT} "\n")
file(APPEND ${LATRD_EXEC_SCRIPT} "${ODINDATA_ROOT_DIR}/bin/frameReceiver --path ${CMAKE_BINARY_DIR}/lib -s LATRD \"$@\"")

install(
	FILES ${LATRD_EXEC_SCRIPT}
	PERMISSIONS OWNER_EXECUTE OWNER_READ
	DESTINATION bin
	)
